<head>
    <meta charset="utf-8" />
    <style>
        * {
            box-sizing: border-box;
        }

        #preview {
            text-align: center;
            font-family: system-ui;
            font-size: 24px;
            margin: 4em;
        }
    </style>
</head>

<body>
    <div id="preview"></div>
    <script src="typemap.js"></script>
    <script src="../functions.js"></script>
    <script>
        async function loadPreview() {
            const { file, path } = await quicklook.getPreviewedFile();
            const url = '../' + getViewerURLByType(path, getFileExt(file.name), '', fileTypeMap);
            document.getElementById("preview").innerHTML += "<a href=" + url + ">Click For Preview</a>";
            window.location = url;
            document.getElementById("preview").innerHTML += "<br>Preview not available";
        }
        loadPreview();
    </script>
</body>